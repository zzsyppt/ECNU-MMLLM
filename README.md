# ECNU DaSE 多模态心理大模型项目

本项目为基于 Llama3 模型的多模态心理健康分析平台。通过分析用户上传的心率数据，系统能够自动生成心理健康评估报告，并提供可视化展示和建议。项目整体结构清晰，分为后端模型部署、API 服务、网页客户端和数据处理等多个模块，旨在通过人工智能技术帮助用户更好地了解其生理和心理状态。

## 目录结构

- **`dependencies/`**：存放项目的本地依赖库，例如 `flash_attn` 等，便于本地环境直接使用。
- **`heartbeat_data/`**：用于存储用户上传的心率数据文件，便于数据管理和后续测试。
- **`llama/`**：Llama3-Chinese 模型部署目录。仓库中上未包含任何Llama3-Chinese模型及配置文件，需用户根据README.md中的地址手动下载到该目录。
- **`server/`**：后端 API 服务目录，使用 FastAPI 框架实现，用于接收来自客户端的请求，处理数据并返回心理健康分析结果。
- **`test_files/`**：包含开发时开发者使用的项目测试文件。
- **`web_client/`**：网页客户端目录，包含 HTML、CSS 和 JavaScript 文件，用于构建用户交互界面，使用户可以上传数据、查看分析结果并下载报告。
- **`requirements.txt`**：项目依赖文件，列出了项目所需的所有 Python 包，便于环境配置。

## 项目功能

1. **心理健康数据分析**：用户可以上传包含心率数据的文件，系统会调用 Llama3 模型对数据进行分析，生成多项心理健康指标，如 RMSSD、SDNN、pNN50 和 SN 等。
2. **可视化展示**：通过网页客户端，用户可以查看心率数据的实时折线图，直观地了解数据变化情况。
3. **心理指标量化**：基于分析结果，系统会生成心理健康量化指标，并以星级形式展示用户的整体能量、放松度、压力指数等状态。
4. **报告下载**：用户可下载完整的心理健康分析报告，其中包括每项指标的解释和相关建议，帮助用户进一步理解和管理自己的心理状态。

## 使用说明

### 前置条件

- 确保 Python 环境已安装，并且满足 `requirements.txt` 中的依赖。
- 配置 GPU 支持以加快 Llama3 模型的加载和推理速度（建议）。
- 确保后端 API 服务正常运行，默认监听端口为 `6007`。

### 环境配置

1. **安装依赖**：
   在项目根目录下，执行以下命令安装所有依赖：
   ```bash
   pip install -r requirements.txt
	```

1. **启动 ECNU-MMLLM API**： 进入 `server/` 目录，并运行模型服务器：

   ```bash
   python server.py
	```

   该服务会启动大模型并监听请求，等待网页客户端的调用。
   ```bash
   uvicorn server:app --host 0.0.0.0 --port 6007
   ```

2. **启动客户端**： 打开 `web_client/index.html` 文件，使用本地浏览器查看网页界面。推荐使用本地服务器（如 `Live Server` 插件）以确保样式和脚本正常加载。

### 功能演示（TODO）

1. **上传心率数据**：点击“数据上传”按钮，选择包含心率数据的文件，系统会自动向后端发送数据请求。
2. **查看分析结果**：上传后，页面会自动显示分析结果，包括心理健康指标的折线图和星级展示。
3. **下载分析报告**：完成数据分析后，点击“报告下载”按钮即可下载一份包含心理健康评估和建议的报告。
4. **查看指标说明**：点击“指标说明”按钮，可以查看各心理指标的定义及其在心理健康评估中的意义。

## 关键技术（TODO）

- **Llama3 大模型**：项目使用了 Llama3 模型对心率数据进行分析，提供多模态心理健康评估。
- **FastAPI**：后端服务使用 FastAPI 框架，以实现高效的异步数据处理和 API 响应。
- **Chart.js**：前端数据可视化使用了 Chart.js 库，用于绘制心率折线图，使数据变化更直观。
- **文件处理与状态管理**：在 `script.js` 中，前端实现了上传数据的解析、文件处理和状态管理，确保用户的操作流畅。

## 注意事项

- **文件格式**：请确保上传的心率数据文件为纯文本格式，数据格式正确，以便系统能够正确解析。
- **兼容性**：本项目建议在现代浏览器（如 Microsoft Edge、Chrome）中运行，确保页面样式与功能正常。
- **网络连接**：项目的网页客户端和后端服务需在同一网络环境下运行，以便客户端能够访问后端 API 服务。

## 贡献指南

如有兴趣参与项目开发或改进，请提交 Pull Request 或 Issues，帮助项目不断优化。

## 许可证

此项目遵循 MIT 许可证，详情见 LICENSE 文件。