import numpy as np

# 示例心率数据，以次/分钟（bpm）为单位
series = "123,123,123,123,123,123,123,125,125,127,125,125,125,124,123,123,125,121,121,121,121,121,121,121,121,121,123,123,123,125,125,125,123,123,123,123,123,123,123,123,121,121,117,115,115,115,115,115,115,115,115,115,115,115,115,115,115,117,117,117,117,115,115,113,113,111,113,113,113,115,115,115,115,115,115,115,115,115,115,115,115,117,117,117,119,119,121,119,119,119,121,121,121,121,121,121,121,121,121,123,123,119,119,122,123,121,120,116,112,116,114,112,110,108,106,106,101,98,96,98,98,98,98,99,94,94,94,97,97,100,98,100,100,100,100,100,99,99,100,99,98,99,100,98,98,99,114,127,127,127,122,119,119,119,121,125,125,126,124,124,123,119,124,124,124,123,123,123,123,121,121,124,124,124,121,123,121,123,121,119,121,123,123,125,123,121,121,123,122,122,119,121,121,119,119,117,115,115,117,119,121,123,121,121,121,119,119,119,119,119,119,118,118,118,117,117,116,116,115,115,115,117,117,117,119,119,116,117,117,117,113,113,116,119,116,116,116,113,117,115,115,114,113,111,111,111,110,110,110,107,107,105,103,103,105,107,109,106,106,109,109,109,109,111,111,112,113,113,115,115,113,113,111,113,113,113,115,115,115,115,117,121,117,116,115,116,116,114,113,113,113,115,114,113,118,120,122,125,125,125,127,123,123,126,125,125,125,125,124,123,122,125,121,119,118,117,115,114,111,111,111,113,109,109,111,113,115,117,119,119,121,123,127,127,127,129,129,125,123,126,127,126,124,124,124,123,127,127,125,125,125,125,123,123,122,119,120,120,120,121,122,119,119,123,123,122,121,120,118,119,119,119,119,119,119,121,122,124,127,127,122,122,122,122,121,121,123,121,123,123,123,120,120,120,118,118,116,116,118,118,118,119,119,120,122,126,131,129,130,130,130,129,130,128,131,131,131,131,131,131,131,130,131,130,129,128,127,126,121,123,125,123,123,124,125,126,128,129,129,129,114,99,98,103,102,102,102,104,104,105,104,105,107,106,107,107,104,108,108,109,111,114,119,122,121,123,121,121,123,123,122,123,124,122,122,121,121,119,116,116,114,109,104,104,105,109,111,113,113,111,109,109,109,109,109,107,107,109,110,110,111,112,117,114,114,114,114,113,112,110,104,104,104,102,97,96,96,100,99,99,97,96,96,95,94,96,99,100,96,96,100,100,102,110,110,119,121,121,117,117,120,120,119,121,123,125,125,125,127,125,125,125,125,123,123,125,124,122,120,115,115,113,115,116,119,121,121,117,117,117,117,117,116,116,119,119,115,113,115,115,116,116,116,115,115,115,114,114,113,113,113,112,111,112,112,113,113,119,116,116,116,111,116,118,118,119,121,121,119,119,123,125,123,125,125,122,121,121,119,119,118,118,119,119,120,119,119,115,117,120,117,121,121,121,121,121,121,117,117,117,121,118,119,117,117,119,119,116,117,115,113,114,115,116,118,118,117,117,117,116,116,116,114,117,117,117,114,114,114,114,114,113,113,112,111,109,105,98,98,93,92,94,95,94,95,100,103,102,100,100,100,104,104,105,106,107,107,117,117,121,121,117,117,115,119,117,115,117,113,111,109,109,109,105,105,105,107,107,107,107,107,107,107,109,109,111,111,113,113,115,115,115,113,111,111,109,107,107,107,109,109,111,111,111,111,111,111,109,109,109,109,109,109,109,109,109,107,107,109,111,111,113,113,111,109,109,109,109,109,109,109,111,111,111,111,109,105,104,104,102,104,104,105,105,107,107,107,107,107,107,107,107,107,107,109,111,113,115,117,117,117,119,119,119,121,119,119,119,117,115,113,111,109,109,107,107,107,107,107,109,111,111,113,115,115,115,117,117,117,117,115,115,115,115,117,117,117,117,115,115,111,111,111,113,113,113,113,113,111,111,109,111,113,113,115,115,111,111,111,109,109,111,111,107,109,110,111,111,109,111,113,113,113,114,114,113,113,110,110,107,106,106,104,104,105,105,106,106,107,108,108,113,113,109,109,105,104,104,104,107,107,109,109,109,107,107,107,107,107,107,109,109,107,108,107,107,105,105,107,107,104,102,99,90,90,95,95,95,99,104,105,105,102,102,100,100,104,105,105,109,109,109,109,109,111,111,111,111,111,109,109,111,108,108,107,107,107,109,109,109,109,111,111,111,107,105,105,105,108,111,111,113,113,111,109,109,109,107,107,107,107,107,107,109,109,111,111,111,111,111,111,109,109,109,110,113,113,111,111,113,113,115,115,115,115,115,115,117,117,116,116,117,117,118,121,119,121,119,121,123,121,123,121,121,121,121,123,123,123,123,123,123,123,123,122,117,119,119,117,115,115,115,111,115,113,113,115,115,115,115"

heart_rates = np.array([int(x) for x in series.split(",")])

# 将心率数据转换为 R-R 间隔（毫秒）
rr_intervals = 60000 / heart_rates  # R-R 间隔（以毫秒为单位）

# 计算 RMSSD
def calculate_rmssd(rr_intervals):
    diff_rr = np.diff(rr_intervals)  # 相邻 R-R 间隔的差
    rmssd = np.sqrt(np.mean(diff_rr**2))  # 差值的均方根
    return rmssd

# 计算 SDNN
def calculate_sdnn(rr_intervals):
    sdnn = np.std(rr_intervals)  # R-R 间隔的标准差
    return sdnn

# 计算 pNN50
def calculate_pnn50(rr_intervals):
    diff_rr = np.diff(rr_intervals)
    nn50 = np.sum(np.abs(diff_rr) > 50)  # 计算相邻间隔差值超过 50 ms 的次数
    pnn50 = (nn50 / len(diff_rr)) * 100  # 超过 50 ms 的差值比例
    return pnn50

# 计算 SN (Sympathetic Nervous Activity Index)
def calculate_sn(rr_intervals):
    sn = np.mean(rr_intervals) / np.std(rr_intervals)  # 平均值与标准差之比
    return sn

# 计算结果
rmssd = calculate_rmssd(rr_intervals)
sdnn = calculate_sdnn(rr_intervals)
pnn50 = calculate_pnn50(rr_intervals)
sn = calculate_sn(rr_intervals)
# 输出结果
print("RMSSD:", rmssd)
print("SDNN:", sdnn)
print("pNN50:", pnn50)
print("SN:", sn)
